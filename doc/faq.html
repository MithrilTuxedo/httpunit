<HTML>
<HEAD><TITLE>HttpUnit FAQ</TITLE></HEAD>
<BODY>
<H1>Frequently Asked Questions</H1>


<OL>
<LI><A HREF="#Cannot unzip">Why can't I unzip the download library?</A></LI>
<LI><A HREF="#org.xml.sax">What is the org.xml.sax package?</A></LI>
<LI><A HREF="#api-help">I don't understand how the ... API works.</A></LI>

</ol><ol start=3>
<LI><A HREF="#uncheck">How do I uncheck a checkbox?</A></LI>

</ol><ol start=4>
<LI><A HREF="sslfaq.html">Does HttpUnit support https?</A></LI>
<LI><A HREF="#proxy">Can I use HttpUnit through a proxy server?</A></LI>
<LI><A HREF="#charset">Why isn't HttpUnit handling my non-English pages?</A></LI>
<LI><A HREF="#badType">The server is not sending a valid content type. How do I test HTML pages anyway?</A></LI>

</ol><ol start=8>
<LI><A HREF="#buttons">HttpUnit is not finding the buttons and parameters in my forms. What is wrong?</A></LI>
<LI><A HREF="#hidden">Why can't I change hidden parameters?</A></LI>

</ol><ol start=10>
<LI><A HREF="#javascript">How do I use HttpUnit to test my pages that use JavaScript?</A></LI>
<LI><A HREF="#norhino">JavaScript is not being executed at all. Why not?</A></LI>
<li><a href="#unsupported">How do I handle a page that uses JavaScript features that HttpUnit does not support?</a></li>
<li><a href="#text">I called document.write() in my page, but getText() does not show the results! Why not?</a></li>

</ol><ol start=14>
<LI><A HREF="#session">How can I see the servlet session between calls?</A></LI>
<li><a href="#JSP">Can I use JSPs with ServletUnit?</a></li>
</OL>


<h2>Problems getting started</h2>

<A NAME="Cannot unzip"><h3>Why can't I unzip the download library?</h3></A>
HttpUnit is archived using the classes in the java.util.zip package. Some older Unzip programs cannot understand this format.
If you are using WinZip, stick to version 7.0 or later.

<A NAME="org.xml.sax"><h3>What is the org.xml.sax package?</h3></A>
You may be getting compile or runtime errors asking for the org.xml.sax package.
You need to have xerces or another XML parser in your classpath. Xerces is included in the download.

<A NAME="#api-help"><h3>I don't understand how the ... API works.<h3></A>
The best way to understand how the API works is to look at the samples in the <tt>test</tt> directory. This contains an example of just about
every feature of the library and is used to verify that they continue to work.
Of course, if you know a tech writer who would like to contribute to improving the documentation, that is always welcome.


<h2>General Use</h2>

<A NAME="uncheck"><h3>How do I uncheck a checkbox?</h3></A>
The setParameter call lets you specify the values per parameter name. An unchecked checkbox has no value to transmit, so you would call:
<pre><code>
    form.setParameter( "checkbox-name", new String[0] );
</code></pre>
or
<pre><code>
    form.removeParameter( "checkbox-name" );
</code></pre>


<h2>Server Issues</h2>

<A NAME="proxy"><h3>Can I use HttpUnit through a proxy server?</h3></A>
Yes. Call <a href="api/com/meterware/httpunit/WebClient.html#setProxyServer(java.lang.String, int)"><code>WebClient.setProxyServer( host, port )</code></a>
before sending your request.


<A NAME="charset"><h3>Why isn't HttpUnit handling my non-English pages?</h3></A>
When no Content-Type header is specified, HTML 1.1 says that the character set is to be taken as iso-8859-1.
Unfortunately, some HTTP servers do not send this parameter correctly, and many browsers incorrectly use this
as an indication that they should determine the character set in some other fashion.  To imitate this behavior,
HttpUnit allows you to set the expected character
set for future pages by calling HttpUnitOptions.setDefaultCharacterSet(). This setting will not apply to those
pages for which the server specifies the character set.
<p>
Non-English form handling is supported as well. Any parameter values entered into a form will be encoded as the same
character set as the document containing the form. The server code will then have to handle those characters
 appropriately. In Java, that would be converting them to Unicode with statements such as<blockquote><code>
String rawName = request.getParameter( "name" );<br>
String japaneseName = new String(name.getBytes("8859_1"),"EUC_JP");
</code></blockquote>
where the proper encoding should be substituted for "EUC_JP". The <code>getBytes</code> call is needed to extract the raw bytes from the parameter string.

<A name="#badType"><h3>The server is not sending a valid content type. How do I test HTML pages anyway?</h3></A>
By default, HttpUnit assumes a content type of "text/plain" unless the server sends the Content-Type header to override
it, as most servers do. If yours is not, you can
call<blockquote><code>HttpUnitOptions.setDefaultContentType( "text/html" );</code></blockquote>before running your tests.
If you are using JUnit, call this method in your <code>setUp()</code> method.

<h2>Form Handling Problems</h2>

<A NAME="buttons"><h3>HttpUnit is not finding the buttons and parameters in my forms. What is wrong?</h3></A>
Usually this indicates some poor nesting of &lt;form&gt tags. Browsers are extremely forgiving of bad HTML, even
handling cases where it is impossible to turn that HTML into a DOM. When a parser encounters such code, it tries
to "fix it" which may not generate exactly the intended results. As of version 1.5.2, HttpUnit is a lot more forgiving,
considering controls to belong to the last opened &lt;form&gt tag, even it was presumed to have been closed. This
seems to match what most browsers do. Under some circumstances switching among the supported parsers may give different
results.

Note that JTidy can display error messages to tell you when there are problems with your HTML. To see them,
call <code>HttpUnitOptions.setParserWarningsEnabled( true )</code> before retrieving your HTML page.

<A name="#hidden"><h3>Why can't I change hidden parameter values?</h3></A>
By default, HttpUnit verifies any parameter value changes against the form containing them. Since a user cannot directly
change hidden parameters, HttpUnit stops you from doing it in your code. If you have to change these values, you have a couple
of choices:<ul>
<li>If you call <code>HttpUnitOptions.setParameterValuesValidated( false )</code> before calling getRequest on your form,
the request will be created with validation disabled and you will be able to set any values you like. Note that in such a case
the order of parameters in the request is not guaranteed, in case your server cares about such things (servlets do not).
<li>You can call <code>&lt;form&gt;.getScriptableObject().setParameterValue( &lt;name&gt;, &lt;value&gt; );</code> to change
the underlying value in the form. This will behave the way JavaScript does - resetting the form will now restore this value,
rather than the original one.
</ul>

<h2>JavaScript support</h2>

<A NAME="javascript"><h3>How do I use HttpUnit to test my pages that use JavaScript?</h3></A>
You should not have to do anything special; however, not all JavaScript constructs are supported as yet. See
<a href="Javascript-support.html">the list of supported JavaScript features</a> for more information.

<A NAME="norhino"><h3>JavaScript is not being executed at all. Why not?</h3></A>
If you do not have the Rhino JAR (js.jar) in your classpath, JavaScript features do not work.

<a name="unsupported"><h3>How do I handle a page that uses JavaScript features that HttpUnit does not support?</h3></a>
If you call<blockquote><code>HttpUnitOptions.setExceptionsThrownOnScriptError( false );</code></blockquote>problems will
recorded but will not throw exceptions.
You can see the list of problems detected by calling<blockquote><code>HttpUnitOptions.getScriptErrorMessages();</code></blockquote>

<a name="#text">I called document.write() in my page, but getText() does not show the results! Why not?</a>
At present, the execution of scripts only affects the parsed result. WebResponse.getText() shows the <i>original</i>
text in the page. You will see the changed text only if you examine text inside a parsed item such as a form, link, or table.

<h2>ServletUnit usage</h2>

<A NAME="session"><h3>How can I see the servlet session between calls?</h3></A>
Servlet session is maintained on the server. Therefore, if you want to do this, you must be using <a href="servletunit-intro.html">ServletUnit</a>.
Once you have that working, you can get take advantage of the power of ServletUnit to get at internal values,
using the <a href="api/com/meterware/servletunit/InvocationContext.html"><code>InvocationContext</code></a> object. For example,
<pre><code>
ServletUnitClient client = ...          // the client you have been using
client.getResponse( servlet-url );      // invoke your servlet normally

// now get an invocation context using the <i>same</i> URL used to invoke the servlet
InvocationContext ic = client.newInvocationContext( servlet-url );
// obain the session just used. Note: pass false to avoid creating it if it does not already exist
HttpSession session = ic.getRequest().getSession( false );</code></pre>

Now you can examine the contents of the session to see what the servlet left in it.

<a name="JSP"><h3>Can I use JSPs with ServletUnit?</h3></a>
Absolutely! But since you are now emulating the servlet environment, you will need to make sure that you have access
to the relevant classes. By default, ServletUnit is configured to use Jasper, the JSP engine which is part of Tomcat.
You will therefore need the Jasper jar in your classpath, along with any on which it depends.  Once you have done that,
your JSPs should run, just as they would in Tomcat.


</BODY></HTML>





